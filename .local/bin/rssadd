#!/bin/sh

u_agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"
echo "$1" | grep www.youtube.com/channel && yt=$(curl -s  "$1" | "$HOME"/descargas/build/pup | grep RSS \
	| grep -Eo '(http|https)://[^"]+')
[ -n "$yt" ] && printf "nombre: " && read -r nombre && echo "$yt \"~ $nombre\"" >> "${XDG_CONFIG_HOME}/newsboat/urls" && notify-send "entrada RSS añadida." \
	&& exit

echo "$1" | grep github.com && printf "nombre: " && read -r nombre \
	&& echo "$1.atom \"~ $nombre\""  >> "${XDG_CONFIG_HOME}/newsboat/urls" \
	&& notify-send "entrada RSS añadida." && exit

#if echo "$1" | grep -q "https*://\S\+\.[A-Za-z]\+\S*" ; then
#	url="$1"
#else
#	url="$(grep -Eom1 '<[^>]+(rel="self"|application/[a-z]+\+xml)[^>]+>' "$1" |
#		grep -o "https?://[^\" ]")"

#	echo "$url" | grep -q "https*://\S\+\.[A-Za-z]\+\S*" ||
#		notify-send "That doesn't look like a full URL." && exit 1
#fi

#RSSFILE="${XDG_CONFIG_HOME:-$HOME/.config}/newsboat/urls"
#if awk '{print $1}' "$RSSFILE" | grep "^$url$" >/dev/null; then
#	notify-send "Ya tienes esta entrada RSS."
#else
#	echo "$url" >> "$RSSFILE" && notify-send "entrada RSS añadida."
#fi
