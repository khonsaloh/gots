#!/bin/sh
# 'cause I wanted to audit the networking of my cellphone
broad=$(sudo ifconfig $(/usr/bin/ls /sys/class/net | grep '^wl') |
	grep broadcast|rev | cut -d' ' -f1 | rev | cut -d'.' -f1,2,3)

for ip in $(seq 1 255); do
	/usr/bin/ping -c 1 $broad.$ip &
done 
# aqui o ideal é xerar algo de tráfico de forma activa
while pidof -q ping ; do
	sleep 2
done
eleccion=$(sudo arp | tail -n +2 | cut -d' ' -f1|fzf)
[ -z "$eleccion" ] && exit
[ ! "$(pidof wireshark)" ] && sudo wireshark -i wlan0 -k -f "host $eleccion and not arp" &
sudo ettercap -i wlan0 -M arp -T //$(route -n | grep 'UG[ \t]' | awk '{print $2}')/ //$eleccion/
#portaEnlace=$(route -n | grep 'UG[ \t]' | awk '{print $2}')
#sudo ettercap -i wlan0 -M arp -T //$portaEnlace/ //$eleccion/ 
